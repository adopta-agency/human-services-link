---
layout: default
title: Algorotoscope Images Working - Archive
---

{% assign count = 0 %}
{% assign locations = site.data.locations %}

<form id="all-data" style="padding: 0px; margin: 0px; width: 100%;">
<table width="90%" align="center">
  {% for location in locations %}
	<tr>
		<td width="20%"><strong>Name:</strong></td>
		<td><input type="text" name="name" id="name-{{ count }}" value="{{ location.name }}" style="width:100%;" /></td>
	</tr>
  <tr>
		<td><strong>Description:</strong></td>
		<td><input type="text" name="description" id="name-{{ count }}" value="{{ location.description }}" style="width:100%;" /></td>
	</tr>
  <tr>
		<td colspan="2"><hr /></td>
	</tr>
  {% assign count = count | plus: 1 %}
{% endfor %}
</table>
</form>

<div class="box alt">
	<div class="row 50% uniform">

		<script type="text/javascript">
		function savethis()
			{
	    var $oAuthToken = getUrlVar('token');
	    var $org = '{{ site.github_user }}';
	    var $repo = '{{ site.github_repo }}';
			var $branch = '{{ site.github_branch }}';

			if($oAuthToken !='')
	      {
	      Cookies.set('token', $oAuthToken);
	      // Set with expiration
	      // Cookies.set('token', $oAuthToken, { expires: '01/01/2017' });
	      }

	    // Grab the token from cookie
	    $oAuthToken = Cookies.get('token');

			$images = new Array();
			var elements = document.getElementById("all-images").elements;
			for (var i = 0, element; element = elements[i++];)
				{
		    if (element.type === "text" || element.type === "hidden" || element.type === "checkbox")
					{

					if(element.name == 'archive')
						{
						$i = {};
						}

		      console.log(element.name);

					$i[element.name] = element.value;

					if(element.name == 'image')
						{
						$images.push($i);
						}
					}
				}
			//console.log($images);
			$yaml_dump = jsyaml.dump($images);

			//document.getElementById('source').value = $yaml_dump;

			// Grab the token from cookie
			$oAuthToken = Cookies.get('token');

			var github = new Github({token: $oAuthToken,auth: "oauth"});
			var repo = github.getRepo($org,$repo);

			repo.getTree('{{ site.github_branch }}?recursive=true', function(err, tree) {

				$.each(tree, function(treeKey, treeValue) {

					$writepath = '_data/images.yaml';
					//console.log($writepath);
					$path = treeValue['path'];
					$sha = treeValue['sha'];
					//console.log($path + ' == ' + $writepath);
					if($path==$writepath)
						{
						repo.writemanual('master',$writepath, $yaml_dump, 'Save', $sha, function(err) { });
						//console.log("writing " + $writepath);
						alert("saved " + $writepath);
						}
					});
				});

			}
		</script>
		<center><p align="center"><input type="button" onclick="savethis();" class="button" value="Save Images" style="text-align: center;" /></p></center>
	</div>
</div>
